<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://fonts.gstatic.com" rel="preconnect" />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;800&display=swap"
      rel="stylesheet"
    />
    <link href="style.css" rel="stylesheet" />
    <title>photo-filter</title>
  </head>
  <body>
    <header class="header">
      <h1 class="header-title">Photo-editor</h1>
    </header>
    <main class="main">
      <div class="filters">
        <label>
          Blur:
          <input
            name="blur"
            data-sizing="px"
            type="range"
            min="0"
            max="10"
            value="0"
          />
          <output name="result">0</output>
        </label>
        <label>
          Invert:
          <input
            name="invert"
            data-sizing="%"
            type="range"
            min="0"
            max="100"
            value="0"
          />
          <output name="result">0</output>
        </label>
        <label>
          Sepia:
          <input
            name="sepia"
            data-sizing="%"
            type="range"
            min="0"
            max="100"
            value="0"
          />
          <output name="result">0</output>
        </label>
        <label>
          Saturate:
          <input
            name="saturate"
            data-sizing="%"
            type="range"
            min="0"
            max="200"
            value="100"
          />
          <output name="result">100</output>
        </label>
        <label>
          Hue rotate:
          <input
            name="hue"
            data-sizing="deg"
            type="range"
            min="0"
            max="360"
            value="0"
          />
          <output name="result">0</output>
        </label>
      </div>
      <div class="editor">
        <div class="btn-container">
          <button class="btn btn-reset">Reset</button>
          <label class="btn btn-load" for="btnInput">
            Load picture
            <input
              class="btn-load--input"
              id="btnInput"
              name="upload"
              type="file"
              placeholder="Load picture"
            />
          </label>
          <button class="btn btn-save">Save picture</button>
        </div>
        <img
          id="originalPhoto"
          src="/foto_filter/assets/img/img.jpg"
          alt="image"
        />
        <canvas class="canvas"></canvas>
      </div>
    </main>
    <footer class="footer">
      <div class="footer-container"></div>
    </footer>
    <button class="fullscreen openfullscreen"></button>
    <nav>
      <section id="filterButtons">
        <div id="reset" class="filter">
          <div class="filter-tag">Normal</div>
        </div>
        <div id="fluorescent" class="filter">
          <div class="filter-tag">Fluorescent</div>
        </div>
        <div id="nostalgia" class="filter">
          <div class="filter-tag">Nostalgia</div>
        </div>
        <div id="phykos" class="filter">
          <div class="filter-tag">Phykos</div>
        </div>
        <div id="lotus" class="filter">
          <div class="filter-tag">Lotus</div>
        </div>
        <div id="memphis" class="filter">
          <div class="filter-tag">Memphis</div>
        </div>
        <div id="deutlich" class="filter">
          <div class="filter-tag">Deutlich</div>
        </div>
        <div id="sumie" class="filter">
          <div class="filter-tag">Sumie</div>
        </div>
        <div id="rockstar" class="filter">
          <div class="filter-tag">Rock Star</div>
        </div>
      </section>
    </nav>
    <script src="filterous.js"></script>
    <script src="filterousEffects.js"></script>
    <script src="index.js"></script>
    <script>
      (function () {
        let originalPhoto = document.getElementById("originalPhoto");

        document
          .getElementById("filterButtons")
          .addEventListener("click", prepFilterEffect, false);

        function prepFilterEffect(e) {
          let filterButton = getFilterButton(e.target);
          if (!filterButton) return;

          ApplyEffects[filterButton.id](originalPhoto, "jpeg");
        }
        function getFilterButton(target) {
          let button;
          if (target.classList.contains("filter")) {
            button = target;
          } else if (target.parentNode.classList.contains("filter")) {
            button = target.parentNode;
          }
          return button;
        }

        let caption = document.getElementById("caption");

        window.addEventListener(
          "hashchange",
          function (e) {
            let hash = location.hash.substr(1);
            originalPhoto.src = hash + ".jpg";
            caption.textContent = photos[hash];
            let prevFilteredPhoto = document.getElementById("filteredPhoto");
            if (prevFilteredPhoto) {
              prevFilteredPhoto.parentNode.removeChild(prevFilteredPhoto);
              originalPhoto.removeAttribute("hidden");
            }
          },
          false
        );
      })();
    </script>
  </body>
</html>
